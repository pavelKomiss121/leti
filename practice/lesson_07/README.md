# Упражнение 7. Сверточные нейронные сети PyTorch для классификации изображений

## Краткая сводка (без кода)

**Среда.** Удобнее выполнять в Google Colab (GPU). Локально возможен запуск на CPU (обучение будет дольше).

**Задача.** Классификация изображений цифр 0–9 по датасету MNIST (28×28, один канал). Загрузка данных — через `torchvision.datasets.MNIST` и `DataLoader` (батчи по 128).

**Базовая модель (п.4).** В методичке сначала даётся не свертка, а полносвязная сеть: Flatten → Linear(28*28, 128) → activation → Linear(128, 128) → activation → Linear(128, 10). Класс `Identical` — тождественная активация (для сравнения); её можно заменить на ReLU и т.п. Вход: `x_batch.float().unsqueeze(1)` — размерность (B, 1, 28, 28).

**Обучение.** CrossEntropyLoss, оптимизатор Adam. Цикл по эпохам и по loaders (train/valid): на train — model.train(), forward, loss.backward(), optimizer.step(); на valid — model.eval(), torch.no_grad(), только forward и подсчёт точности. Точность на первой и последней итерации — из вывода в консоль.

**Улучшения (п.7).** Смена активации (ReLU), подбор lr и числа эпох, другой оптимизатор (SGD, AdamW). Документация: https://pytorch.org/docs/stable/nn.html#non-linear-activations-weighted-sum-nonlinearity, https://pytorch.org/docs/stable/optim.html.

**Transfer learning (п.8).** Модель из torchvision (например, resnet18 с pretrained=True). Заморозить первые три дочерних модуля (parameters requires_grad=False). Адаптировать под MNIST: вход 1 канал (или 3 копии канала), размер входа под ResNet (например, 224×224 через resize), заменить последний полносвязный слой на выход из 10 классов. Обучать только незамороженные слои. Цель — повысить точность на тестовой выборке.

## Суть для защиты

- Чем сверточный слой отличается от полносвязного; зачем при переносе модели замораживать первые слои.
- Зачем переводить модель в model.train() / model.eval() и использовать torch.no_grad() на валидации.
- Что даёт transfer learning при малом объёме данных и как подгонять готовую архитектуру под свою задачу (число классов, размер входа).
