# Лабораторная работа 4. Нейронные сети

**Цель:** создание простейшей нейронной сети на Python без специализированных библиотек (только numpy); реализация прямого и обратного распространения, обучение по MSE, расчёт точности и построение графиков потерь и точности.

---

## Как запустить

Из корня проекта `leti`:

```bash
pip install -r requirements.txt
python -m lab4.main
```

Скрипт выведет процесс обучения по эпохам, итоговую точность и MSE, веса слоёв, сохранит графики в `lab4/figures/`; затем выполнит оценку на тестовой выборке (70/30) и подбор числа нейронов и эпох.

---

## Откуда берутся данные

Используется генератор из лабораторной работы 1 ([lab1/DataGenerator.py](../lab1/DataGenerator.py)): функция `norm_dataset` — два класса с нормальным распределением по признакам (параметры mu0, mu1, sigma0, sigma1). Метки Y приводятся к форме (n_samples, 1) для совместимости с нейросетью.

В основной части обучение и метрики считаются на всей выборке; в дополнительном блоке данные делятся 70% обучающая / 30% тестовая для оценки методом `test()`.

---

## Что делает скрипт

1. **Модель нейросети (lab4/model.py)**  
   Класс `NeuralNetwork`: один скрытый слой с сигмоидой, один выход. Методы: `feedforward` (прямое распространение), `backprop` (обратное распространение по градиенту MSE), `train_step`, `test(X)` для предсказания на новых данных.

2. **Обучение**  
   Цикл по эпохам: на каждой эпохе выполняется прямой проход, расчёт MSE и точности (порог 0.5), обновление весов через backprop. История loss и accuracy записывается для графиков.

3. **Итоговые метрики и веса**  
   После обучения выводятся итоговая точность и MSE на обучающей выборке; веса первого и второго слоёв копируются в переменные `weights_layer1`, `weights_layer2` для отчёта.

4. **Графики**  
   Строятся два графика в одном рисунке: зависимость MSE и точности от номера эпохи. Файл: `lab4/figures/lab4_loss_accuracy.png`.

5. **Оценка на тестовой выборке (метод test)**  
   Данные делятся 70/30; сеть заново обучается на 70%, затем на 30% вызывается `NN.test(Xtest)`. Выводятся точность на обучающей и тестовой выборках.

6. **Подбор гиперпараметров**  
   Перебор числа нейронов (2, 4, 8, 16) и числа эпох (30, 50, 100) на всей выборке; для каждой комбинации — финальная точность; выбирается комбинация с максимальной точностью.

---

## Создаваемые файлы

| Файл | Описание |
|------|----------|
| `lab4/figures/lab4_loss_accuracy.png` | Графики функции потерь (MSE) и точности от номера эпохи. |

Ответы на вопросы для самоконтроля — в **QUESTIONS_ANSWERS.md**.
